package vestige.impl.module.exploit;

import vestige.api.event.Listener;
import vestige.api.event.impl.MotionEvent;
import vestige.api.event.impl.UpdateEvent;
import vestige.api.module.Category;
import vestige.api.module.Module;
import vestige.api.module.ModuleInfo;
import vestige.api.setting.impl.ModeSetting;
import vestige.api.setting.impl.NumberSetting;
import vestige.util.world.WorldUtil;

@ModuleInfo(name = "Antivoid", category = Category.EXPLOIT)
public class Antivoid extends Module {
	
	private double x, y, z;
	
	private final ModeSetting mode = new ModeSetting("Mode", this, "Vanilla", "Vanilla", "Setback");
	private final NumberSetting minFallDist = new NumberSetting("Min fall dist", this, 3, 1, 10, 0.2, false);
	
	public Antivoid() {
		this.registerSettings(mode, minFallDist);
	}
	
	@Listener
	public void onUpdate(UpdateEvent event) {
		if(mc.thePlayer.onGround && WorldUtil.isBlockUnder()) {
			x = mc.thePlayer.posX;
			y = mc.thePlayer.posY;
			z = mc.thePlayer.posZ;
		}
		
		switch (mode.getMode()) {
			case "Vanilla":
				if(!WorldUtil.isBlockUnder() && mc.thePlayer.fallDistance > minFallDist.getCurrentValue()) {
					mc.thePlayer.setPosition(x, y, z);
				}
				break;
		}
	}
	
	@Listener
	public void onMotion(MotionEvent event) {
		switch (mode.getMode()) {
			case "Setback":
				if(!WorldUtil.isBlockUnder() && mc.thePlayer.fallDistance > minFallDist.getCurrentValue()) {
					event.setY(mc.thePlayer.posY + 7 + Math.random() * 2);
				}
			break;
		}
	}

}