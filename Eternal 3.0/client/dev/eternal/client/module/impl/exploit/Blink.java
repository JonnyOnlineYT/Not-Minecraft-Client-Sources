package dev.eternal.client.module.impl.exploit;

import dev.eternal.client.event.Subscribe;;
import dev.eternal.client.event.events.EventPacket;
import dev.eternal.client.event.events.EventTeleport;
import dev.eternal.client.module.Module;
import dev.eternal.client.module.api.ModuleInfo;
import dev.eternal.client.util.network.PacketUtil;
import net.minecraft.network.Packet;
import net.minecraft.network.play.server.S00PacketKeepAlive;

import java.util.ArrayList;

@ModuleInfo(name = "Blink", description = "Cancels all packets for a bit", category = Module.Category.EXPLOIT)
public class Blink extends Module {

  private final ArrayList<Packet<?>> packets = new ArrayList<>();
  private double x, y, z;

  @Override
  protected void onDisable() {
    System.out.println(packets);
    packets.forEach(PacketUtil::sendNoEvent);
    packets.clear();
  }

  @Subscribe
  public void onPacket(EventPacket eventPacket) {
    if (eventPacket.direction() == EventPacket.Direction.OUT) {
      eventPacket.cancelled(true);
      packets.add(eventPacket.getPacket());
    } else if (eventPacket.direction() == EventPacket.Direction.IN)
      if (mc.theWorld != null)
        if (!(eventPacket.getPacket() instanceof S00PacketKeepAlive))
          eventPacket.cancelled(true);
  }

  @Subscribe
  public void onTeleport(EventTeleport eventTeleport) {
    System.out.println("Tets");
//        eventTeleport.trySafeReject(8);
  }

}
